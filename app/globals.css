@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================================
   ベース設定（iOS風トークン）
   ========================================= */

:root {
  /* 色（既存：コーポレートネイビー系） */
  --background: 0 0% 100%;
  --foreground: 222.2 47.4% 11.2%;
  --card: 0 0% 100%;
  --card-foreground: 222.2 47.4% 11.2%;
  --popover: 0 0% 100%;
  --popover-foreground: 222.2 47.4% 11.2%;

  /* P3（最小変更） */
  --primary: 214 52% 24.5%;
  --primary-foreground: 210 40% 98%;
  --secondary: 210 40% 96.1%;
  --secondary-foreground: 222.2 47.4% 11.2%;
  --muted: 210 40% 96.1%;
  --muted-foreground: 215.4 16.3% 46.9%;
  --accent: 210 40% 96.1%;
  --accent-foreground: 222.2 47.4% 11.2%;

  /* S3（成功・破壊） */
  --success: 194 70% 27%;
  --success-foreground: 210 40% 98%;
  --destructive: 0 74% 42%;
  --destructive-foreground: 210 40% 98%;

  --border: 214.3 31.8% 91.4%;
  --input: 214.3 31.8% 91.4%;
  --ring: 222.2 84% 4.9%;

  /* 角丸（iOS寄り） */
  --radius: 0.75rem;

  /* ====== UIトークン（角丸） ====== */
  --ui-radius-sm: 0.5rem;
  --ui-radius-md: 0.75rem;
  --ui-radius-lg: 1rem;
  --ui-radius-full: 9999px;

  /* ====== UIトークン（余白） ====== */
  --spacing-0: 0rem;
  --spacing-1: 0.25rem;
  --spacing-2: 0.5rem;
  --spacing-3: 0.75rem;
  --spacing-4: 1rem;
  --spacing-5: 1.25rem;
  --spacing-6: 1.5rem;
  --spacing-7: 1.75rem;
  --spacing-8: 2rem;

  /* 半透明ガラス */
  --ui-glass-bg: 255 255 255 / 0.6;
  --ui-glass-border: 0 0 0 / 0.06;
  --ui-glass-blur: 16px;

  /* 影 */
  --ui-shadow-sm: 0 1px 2px rgba(0,0,0,0.06);
  --ui-shadow-md: 0 8px 20px rgba(0,0,0,0.08);

  /* Hairline区切り */
  --ui-separator: 0 0 0 / 0.08;

  /* ===============================
     ボタントークン（唯一の真実）
     =============================== */
  --btn-px: 0.875rem;  /* px-3.5 */
  --btn-py: 0.375rem;  /* py-1.5 */
  --btn-h:  2.5rem;    /* h-10 */
}

.dark {
  --background: 222.2 47.4% 11.2%;
  --foreground: 210 40% 98%;
  --card: 222.2 47.4% 11.2%;
  --card-foreground: 210 40% 98%;
  --popover: 222.2 47.4% 11.2%;
  --popover-foreground: 210 40% 98%;
  --primary: 213 65% 15%;
  --primary-foreground: 210 40% 98%;
  --secondary: 217.2 32.6% 17.5%;
  --secondary-foreground: 210 40% 98%;
  --muted: 217.2 32.6% 17.5%;
  --muted-foreground: 215 20.2% 65.1%;
  --accent: 217.2 32.6% 17.5%;
  --accent-foreground: 210 40% 98%;

  --success: 194 70% 27%;
  --success-foreground: 210 40% 98%;
  --destructive: 0 74% 42%;
  --destructive-foreground: 210 40% 98%;

  --border: 217.2 32.6% 17.5%;
  --input: 217.2 32.6% 17.5%;
  --ring: 210 40% 98%;

  --ui-glass-bg: 20 20 20 / 0.5;
  --ui-glass-border: 255 255 255 / 0.08;
  --ui-glass-blur: 16px;

  --ui-shadow-sm: 0 1px 2px rgba(0,0,0,0.5);
  --ui-shadow-md: 0 8px 20px rgba(0,0,0,0.45);

  --ui-separator: 255 255 255 / 0.1;
}

/* =========================================
   Base（＋リスト再発対策）
   ========================================= */
@layer base {
  * { @apply border-border; }
  body { @apply bg-background text-foreground; }

  /* 通常コンテンツでは箇条書きを維持 */
  ul { list-style: disc; padding-left: 1.25rem; margin: 0.5rem 0; }
  ol { list-style: decimal; padding-left: 1.5rem;  margin: 0.5rem 0; }
  li { line-height: 1.6; overflow: visible; margin: 0.25rem 0; }
  li > ul, li > ol { margin-top: 0.25rem; margin-bottom: 0.25rem; }
  :where(ul,ol) :where(p) { margin: 0.25rem 0; }

  table { @apply w-full border-collapse; }
  th, td { @apply p-3 align-middle; }
  thead th { @apply text-sm text-muted-foreground; }

  input, textarea, select, button { border-radius: var(--ui-radius-md); }
  input:focus, textarea:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 3px hsl(var(--ring) / 0.25);
  }
}

/* =========================================
   Components
   ========================================= */

/* ガラス面（@applyを使っていないので @layer外でもOK） */
.glass {
  background: rgba(var(--ui-glass-bg));
  backdrop-filter: blur(var(--ui-glass-blur));
  -webkit-backdrop-filter: blur(var(--ui-glass-blur));
  border: 1px solid rgba(var(--ui-glass-border));
  border-radius: var(--ui-radius-lg);
  box-shadow: var(--ui-shadow-sm);
}

/* Hairline 区切り */
.hairline { border-top: 1px solid rgba(var(--ui-separator)); }

/* =========================================
   Buttons（@apply を使うため components レイヤー内に配置）
   ========================================= */
@layer components {
  .ui-btn,
  .btn {
    @apply inline-flex items-center justify-center text-sm font-medium
           focus-visible:outline-none focus-visible:ring-2
           focus-visible:ring-primary focus-visible:ring-offset-2
           focus-visible:ring-offset-background select-none;
    height: var(--btn-h);
    padding-inline: var(--btn-px);
    padding-block: var(--btn-py);
    gap: 0.375rem;
    line-height: 1;
    white-space: nowrap;
    border-radius: var(--ui-radius-md);
    box-shadow: var(--ui-shadow-sm);
    transition: background-color .15s ease, color .15s ease, box-shadow .15s ease;
  }
  .ui-btn:hover, .btn:hover { filter: brightness(0.98); }
  .ui-btn:disabled, .btn:disabled,
  .ui-btn[aria-disabled="true"], .btn[aria-disabled="true"] { opacity: .6; cursor: not-allowed; }

  /* バリアント（色・枠のみ） */
  .btn-primary {
    @apply text-primary-foreground;
    background-color: hsl(var(--primary));
  }
  .btn-primary:hover { background-color: hsl(var(--primary) / .92); }

  .btn-outline {
    @apply text-foreground;
    background-color: hsl(var(--secondary) / .55);
    border: 1px solid hsl(var(--border));
    box-shadow: var(--ui-shadow-sm);
  }
  .btn-outline:hover { background-color: hsl(var(--secondary) / .75); }

  .btn-success { color: hsl(var(--success-foreground)); background-color: hsl(var(--success)); }
  .btn-success:hover { background-color: hsl(var(--success) / .9); }

  .btn-danger { color: hsl(var(--destructive-foreground)); background-color: hsl(var(--destructive)); }
  .btn-danger:hover { background-color: hsl(var(--destructive) / .9); }

  /* サイズ差分（余白はトークンから算出） */
  .btn-sm { height: calc(var(--btn-h) - 0.25rem); border-radius: var(--ui-radius-sm); }
  .btn-lg { height: calc(var(--btn-h) + 0.25rem); border-radius: var(--ui-radius-lg); }

  /* CTA（pill） */
  .btn-cta {
    @apply font-semibold;
    border-radius: var(--ui-radius-full);
    box-shadow: var(--ui-shadow-md);
  }

  /* Segmented / Tablist（ダッシュボードの点除去） */
  ul.segmented,
  ul[role="tablist"],
  nav ul.segmented {
    list-style: none;
    padding-left: 0;
    margin-left: 0;
  }
  ul.segmented > li,
  ul[role="tablist"] > li {
    display: inline-flex;
  }
}

/* =========================================
   Utilities
   ========================================= */
@layer utilities {
  .shadow-soft { box-shadow: var(--ui-shadow-sm); }
  .shadow-soft-md { box-shadow: var(--ui-shadow-md); }
}
